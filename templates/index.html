<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ex√°menes Test - Inicio</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Sistema de ex√°menes</h1>
            <p class="subtitle">Organizaci√≥n y gesti√≥n del centro</p>
            <p class="subtitle-small">M√°ster universitario en Formaci√≥n del profesorado de Ed. Secundaria, Bachillerato, FP e Idiomas</p>
            <p class="subtitle">Selecciona el modo de examen que deseas realizar</p>
        </header>

        <main>
            <div class="modos-container">
                <div class="modo-card">
                    <div class="modo-icono">üìù</div>
                    <h2>Examen sin revisi√≥n</h2>
                    <p class="modo-descripcion">
                        Responde 10 preguntas aleatorias y obt√©n tus resultados al final.
                        No podr√°s ver si acertaste hasta completar todo el examen.
                    </p>
                    <ul class="modo-caracteristicas">
                        <li>‚úì 10 preguntas aleatorias</li>
                        <li>‚úì Correcci√≥n al finalizar</li>
                        <li>‚úì Ver todas las respuestas correctas</li>
                    </ul>
                    <a href="/examen/sin-revision" class="btn btn-primary btn-large">
                        Iniciar examen sin revisi√≥n
                    </a>
                    
                    <div class="tema-especifico-section">
                        <div class="divider">
                            <span>o selecciona un tema espec√≠fico</span>
                        </div>
                        <div class="tema-selector-container">
                            <label for="tema-sin-revision">Tema:</label>
                            <select id="tema-sin-revision" class="tema-select">
                                <option value="">Cargando temas...</option>
                            </select>
                            <button id="btn-tema-sin-revision" class="btn btn-secondary">
                                Iniciar por tema
                            </button>
                        </div>
                    </div>
                </div>

                <div class="modo-card">
                    <div class="modo-icono">‚úÖ</div>
                    <h2>Examen con revisi√≥n</h2>
                    <p class="modo-descripcion">
                        Responde 10 preguntas aleatorias y recibe retroalimentaci√≥n inmediata
                        despu√©s de cada respuesta.
                    </p>
                    <ul class="modo-caracteristicas">
                        <li>‚úì 10 preguntas aleatorias</li>
                        <li>‚úì Correcci√≥n inmediata</li>
                        <li>‚úì Aprende mientras practicas</li>
                    </ul>
                    <a href="/examen/con-revision" class="btn btn-success btn-large">
                        Iniciar examen con revisi√≥n
                    </a>
                    
                    <div class="tema-especifico-section">
                        <div class="divider">
                            <span>o selecciona un tema espec√≠fico</span>
                        </div>
                        <div class="tema-selector-container">
                            <label for="tema-con-revision">Tema:</label>
                            <select id="tema-con-revision" class="tema-select">
                                <option value="">Cargando temas...</option>
                            </select>
                            <button id="btn-tema-con-revision" class="btn btn-success-secondary">
                                Iniciar por tema
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Sistema de ex√°menes tipo test - Las preguntas son seleccionadas aleatoriamente</p>
            <p class="author-credit">Desarrollado por Jaime Gonz√°lez Casero</p>
        </footer>
    </div>
    
    <script>
        // Cargar temas disponibles al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('/api/temas');
                const data = await response.json();
                
                // Poblar ambos selectores
                const selectSinRevision = document.getElementById('tema-sin-revision');
                const selectConRevision = document.getElementById('tema-con-revision');
                
                const opcionesHTML = '<option value="">Selecciona un tema</option>' +
                    data.temas.map(tema => 
                        `<option value="${tema.id}">${tema.nombre}</option>`
                    ).join('');
                
                selectSinRevision.innerHTML = opcionesHTML;
                selectConRevision.innerHTML = opcionesHTML;
                
                // Agregar event listeners a los botones
                document.getElementById('btn-tema-sin-revision').addEventListener('click', () => {
                    const tema = selectSinRevision.value;
                    if (tema) {
                        window.location.href = `/examen/sin-revision?tema=${tema}`;
                    } else {
                        alert('Por favor, selecciona un tema');
                    }
                });
                
                document.getElementById('btn-tema-con-revision').addEventListener('click', () => {
                    const tema = selectConRevision.value;
                    if (tema) {
                        window.location.href = `/examen/con-revision?tema=${tema}`;
                    } else {
                        alert('Por favor, selecciona un tema');
                    }
                });
                
            } catch (error) {
                console.error('Error al cargar temas:', error);
                document.getElementById('tema-sin-revision').innerHTML = 
                    '<option value="">Error al cargar temas</option>';
                document.getElementById('tema-con-revision').innerHTML = 
                    '<option value="">Error al cargar temas</option>';
            }
        });
    </script>
</body>
</html>
